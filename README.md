# Virtual File System

## Характеристики файловой системы

* Размер блока по умолчанию равен 4096 B = 4 KB
* Максимальный размер файла в блоках составляет 8+512+512*512 = 262664
* Максимальный размер файла в байтах составляет 262664 * 4 KB = 1050656 KB = 1026,03125 MB
* Размер хранилища в блоках по умолчанию составляет 16384
* Размер хранилища в байтах по умолчанию составляет 16384 * 4 KB = 65536 KB = 64 MB
* Для хранения файлов по умолчанию создается 4 физических файла-хранилища
* Ограничение на количество создаваемых файлов по умолчанию задается равным 1000000

## Подключение библиотеки

* Установите директорию `vfs` в корневую директорию вашего проекта
* Перейдите в нее и выполните команду `make`  
  `$ cd vfs && make`
* При сборке вашего проекта укажите компилятору флаги `-lvfs -Lvfs`  
  `$ g++ -o project mod1.o mod2.o mod3.o -lvfs -Lvfs`
* Для использования библиотечных определений подключается заголовочный файл `"vfs/ivfs.hpp"`  
  `#include "vfs/ivfs.hpp"`

## Использование библиотеки

* `IVFS vfs` - класс файловая система
* `File f` - класс файл
* `vfs.Mount(path)` - прочитать файловую систему
* `vfs.Umount()` - закрыть файловую систему
* `vfs.Open(path, perms)` - открыть файл
* `vfs.Delete(path)` - удалить файл
* `f.Read(buf, len)` - чтение данных из файла
* `f.Write(buf, len)` - запись данных в файл
* `f.Lseek(offset, whence)` - переместить курсор в файле
* `f.Close()` - закрыть файл
* `f.Size()` - возвращает размер файла в байтах

## make команды

* `make prog` - выполняет сборку проекта
* `make run` - выполняет сборку и осуществляет запуск проекта
* `make memcheck` - запускает проект с valgrind
* `make vfstest` - выполняет тесты виртуальной файловой системы
* `make tags` - генерирует tags файлы для работы в vim
* `make clean` - выполняет очистку от мусорных файлов

