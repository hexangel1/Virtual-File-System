# Virtual File System

## Характеристики файловой системы

* Размер блока по умолчанию равен 4096 B = 4 KB
* Максимальный размер файла в блоках составляет 8+512+512*512 = 262664
* Максимальный размер файла в байтах составляет 262664 * 4 KB = 1050656 KB = 1026,03125 MB
* Размер хранилища в блоках по умолчанию составляет 16384
* Размер хранилища в байтах по умолчанию составляет 16384 * 4 KB = 65536 KB = 64 MB
* Для хранения файлов по умолчанию создается 4 физических файла-хранилища
* Ограничение на количество создаваемых файлов по умолчанию задается равным 1000000
* Ограничение на длину имени файла установлено в 52 символа

## Подключение библиотеки

* Установите директорию `vfs` в корневую директорию вашего проекта
* Перейдите в нее и выполните команду `make`  
  `$ cd vfs && make`
* При сборке вашего проекта укажите компилятору флаги `-lvfs -Lvfs`  
  `$ g++ -o project mod1.o mod2.o mod3.o -lvfs -Lvfs`
* Для использования библиотечных определений подключается заголовочный файл `"vfs/ivfs.hpp"`  
  `#include "vfs/ivfs.hpp"`

## Интерфейс файловой системы

* `IVFS vfs` - класс файловая система  
* `File *f` - указатель на файл  
* `bool Boot(const char *path, bool makefs = false)`  
        - загрузить файловую систему
* `bool Create(const char *path, bool directory = false)`  
        - создать файл
* `bool Remove(const char *path, bool recursive = false)`  
        - удалить файл
* `bool Rename(const char *oldpath, const char *newpath)`  
        - переименовать файл
* `File *Open(const char *path, const char *flags)`  
        - открыть файл
* `void Close(File *fp)`  
        - закрыть файл
* `ssize_t Read(File *fp, char *buf, size_t len)`  
        - прочитать данные из файла
* `ssize_t Write(File *fp, const char *buf, size_t len)`  
        - записать данные в файл
* `off_t Lseek(File *fp, off_t offset, int whence)`  
        - выполнить позиционирование в файле
* `off_t Size(File *fp) const`  
        - получить размер файла в байтах

## make команды

* `make prog` - выполняет сборку проекта
* `make run` - выполняет сборку и осуществляет запуск проекта
* `make memcheck` - запускает проект с valgrind
* `make vfstest` - выполняет тесты виртуальной файловой системы
* `make tags` - генерирует tags файлы для работы в vim
* `make clean` - выполняет очистку от мусорных файлов

